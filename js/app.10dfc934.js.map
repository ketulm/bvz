{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?a761","webpack:///./src/data/resources.js","webpack:///./src/views/GeoHeatmap.vue?736e","webpack:///./src/components/Heatmap.vue?61f6","webpack:///./src/data/constants.js","webpack:///./src/utils/index.js","webpack:///./src/components/Barchart.vue?90f2","webpack:///src/components/Barchart.vue","webpack:///./src/components/Barchart.vue?8b66","webpack:///./src/components/Barchart.vue?7c8f","webpack:///src/components/Heatmap.vue","webpack:///./src/components/Heatmap.vue?4674","webpack:///./src/components/Heatmap.vue?512c","webpack:///./src/components/Stackedbar.vue?53ac","webpack:///src/components/Stackedbar.vue","webpack:///./src/components/Stackedbar.vue?1473","webpack:///./src/components/Stackedbar.vue","webpack:///src/views/GeoHeatmap.vue","webpack:///./src/views/GeoHeatmap.vue?7cc5","webpack:///./src/views/GeoHeatmap.vue","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue?bff9","webpack:///./src/registerServiceWorker.js","webpack:///./src/router/index.js","webpack:///./src/store/index.js","webpack:///./src/main.js","webpack:///./src/App.vue?c650","webpack:///./src/components/Heatmap.vue?7b37","webpack:///./src/components/Barchart.vue?7ebf","webpack:///./src/views/GeoHeatmap.vue?5fda"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","_v","_s","yearsTitle","isLoading","model","callback","$$v","incidentType","expression","_e","directives","rawName","neighborhoods","stations","incidents","incidentsSummary","year","month","staticRenderFns","NEIGHBORHOODS","process","POLICE_STATIONS","VISION_ZERO","ref","numBoxSelectedIncidents","height","width","rightClip","allIncidents","boxSelectedIncidents","on","updateSelection","allSummary","yearly","yearRange","chartHeight","chartWidth","margin","stats","barHeight","cellHeight","selected","style","right","hour","legendWidth","legendMargin","left","HOURS","MONTHS","toggleSpinner","domElement","element","getElementsByClassName","classList","contains","remove","replace","add","scaleColor","d3","hex","scaleColorSelection","props","barsData","undefined","min","max","computed","vertical","barWidth","watch","chartData","deep","handler","totals","type","updateBarChartHorizontal","updateBarChartVertical","svg","methods","chartG","attr","component","components","cellWidth","bottom","top","chart","sizeScale","nested","years","months","hours","Infinity","filterAndProcessIncidents","clearChart","updateChart","legendHeight","$refs","heatmap","mode_type","forEach","values","total","htotal","mtotal","ytotal","filtered","map","totalByHour","class","$set","totalsByYear","flat","totalsByMonth","selectByHour","$emit","selectByMonth","createScale","ygroup","mgroup","updateLegend","showBoxSelectedIncidents","select","ticks","title","g","selectAll","updateBarChart","console","log","bars","xAxis","updateBarChartH","color","heatmapData","projection","path","quadtree","hover","x","y","refreshing","selectedIncidents","createMapVis","convertData","processAndFilterData","updateSelectionSvg","updateSelectionCanvas","updateHeatMap","moveHoverBox","updateHoverSelection","mapLayer","updateStations","addAll","mapvis","heat","radius","gradient","1","0.5","0","draw","visit","node","points","x1","x3","y1","y3","x2","x0","y2","y0","monthly","hourly","animate","updateInterval","updateMap","clearInterval","register","ready","registered","cached","updatefound","updated","offline","error","Vue","use","VueRouter","routes","GeoHeatmap","router","Vuex","Store","state","count","mutations","actions","Buefy","config","productionTip","store","render","h","App","$mount"],"mappings":"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","file":"js/app.10dfc934.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('header',{staticClass:\"header\"},[_c('h1',{staticClass:\"title\"},[_vm._v(\" Boston Traffic Incidents \"),_c('span',{staticClass:\"subtitle\"},[_vm._v(_vm._s(_vm.yearsTitle))])]),(_vm.isLoading != true)?_c('nav',{staticClass:\"header--navigation is-right\"},[_c('b-field',[_c('b-radio-button',{attrs:{\"size\":\"is-small\",\"native-value\":\"*\",\"title\":\"Show all incident types\"},model:{value:(_vm.incidentType),callback:function ($$v) {_vm.incidentType=$$v},expression:\"incidentType\"}},[_c('span',[_vm._v(\"All\")])]),_c('b-radio-button',{attrs:{\"size\":\"is-small\",\"native-value\":\"mv\",\"title\":\"Show incidents involving motor vehicles\"},model:{value:(_vm.incidentType),callback:function ($$v) {_vm.incidentType=$$v},expression:\"incidentType\"}},[_c('b-icon',{attrs:{\"icon\":\"car\",\"pack\":\"mdi\",\"size\":\"is-small\"}}),_c('span',[_vm._v(\"Motor vehicle\")])],1),_c('b-radio-button',{attrs:{\"size\":\"is-small\",\"native-value\":\"bike\",\"title\":\"Show incidents involving bikes\"},model:{value:(_vm.incidentType),callback:function ($$v) {_vm.incidentType=$$v},expression:\"incidentType\"}},[_c('b-icon',{attrs:{\"icon\":\"bike\",\"pack\":\"mdi\",\"size\":\"is-small\"}}),_c('span',[_vm._v(\"Bike\")])],1),_c('b-radio-button',{attrs:{\"size\":\"is-small\",\"native-value\":\"ped\",\"title\":\"Show incidents involving pedestrians\"},model:{value:(_vm.incidentType),callback:function ($$v) {_vm.incidentType=$$v},expression:\"incidentType\"}},[_c('b-icon',{attrs:{\"icon\":\"walk\",\"pack\":\"mdi\",\"size\":\"is-small\"}}),_c('span',[_vm._v(\"Pedestrian\")])],1)],1)],1):_vm._e()]),_c('section',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isLoading != true),expression:\"isLoading != true\"}],staticClass:\"vis\"},[_c('geo-heatmap',{attrs:{\"neighborhoods\":_vm.neighborhoods,\"stations\":_vm.stations,\"allIncidents\":_vm.incidents,\"allSummary\":_vm.incidentsSummary,\"year\":_vm.year,\"month\":_vm.month,\"incidentType\":_vm.incidentType}})],1),_c('div',{staticClass:\"app--footer\"},[_vm._v(\"© 2020 Ketul Mavani\")])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export const INCIDENTS = process.env.BASE_URL + \"data/crime_data.json\";\r\n\r\nexport const BOUNDARY =\r\n  process.env.BASE_URL + \"data/City_of_Boston_Boundary.geojson\";\r\n\r\nexport const NEIGHBORHOODS =\r\n  process.env.BASE_URL + \"data/Boston_Neighborhoods.geojson\";\r\n\r\nexport const POLICE_STATIONS =\r\n  process.env.BASE_URL + \"data/Boston_Police_Stations.geojson\";\r\n\r\nexport const POLICE_DISTRICTS =\r\n  process.env.BASE_URL + \"data/Police_Districts.geojson\";\r\n\r\nexport const VISION_ZERO = process.env.BASE_URL + \"data/vision_zero_ss.json\";\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mapvis--container\"},[_c('div',{ref:\"mapvis\",staticClass:\"mapvis\"},[(_vm.numBoxSelectedIncidents > 0)?_c('div',{staticClass:\"mapvis--title subtitle\"},[_vm._v(\" \"+_vm._s(_vm.numBoxSelectedIncidents)+\" incidents \")]):_vm._e(),_c('svg',{ref:\"mapSvg\",staticClass:\"mapvis--svg\",attrs:{\"height\":_vm.height,\"width\":_vm.width - _vm.rightClip}}),_c('canvas',{ref:\"mapCanvas\",staticClass:\"mapvis--canvas\",attrs:{\"height\":_vm.height,\"width\":_vm.width - _vm.rightClip}}),_c('svg',{ref:\"mapSvgSelection\",staticClass:\"mapvis--canvas__selection mapvis--canvas__selectionsvg\",attrs:{\"height\":_vm.height,\"width\":_vm.width - _vm.rightClip}}),_c('canvas',{ref:\"mapCanvasSelection\",staticClass:\"mapvis--canvas__selection\",attrs:{\"height\":_vm.height,\"width\":_vm.width - _vm.rightClip}})]),_c('div',{staticClass:\"sumvis--container\"},[_c('heatmap',{attrs:{\"allIncidents\":_vm.allIncidents,\"boxSelectedIncidents\":_vm.boxSelectedIncidents,\"incidentType\":_vm.incidentType},on:{\"selected\":_vm.updateSelection}}),_c('div',{staticClass:\"sumvis--summary\"},[_c('stackedbar',{attrs:{\"chartData\":_vm.allSummary.yearly,\"width\":170,\"height\":220,\"title\":\"All\"}}),_c('article',{staticClass:\"sumvis--description is-half\"},[_c('p',[_vm._v(\" Vision Zero is a multi-national initiative that aims to eliminate serious or fatal traffic incidents by 2030. This visualization shows all the serious incidents that occurred in Boston, MA \"+_vm._s(_vm.yearRange)+\" using the data provided by \"),_c('a',{attrs:{\"href\":\"https://data.boston.gov/dataset/vision-zero-crash-records\"}},[_vm._v(\"data.boston.gov\")]),_vm._v(\". \")]),_c('br'),_c('p',[_vm._v(\" This interactive visualization capability shows geographic and temporal hotspots where many of these incidents occur. \")]),_c('br'),_c('p',[_vm._v(\" Using the incident type filter, places where serious incidents involving pedestrian or bicycle can be focused on. Using the calendar chart, incidents that occure at certain hour, in certain month, or at certain hour across all years can be highlighted in the map view. \")]),_c('br')])],1)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"heatmap\",staticClass:\"heatmap is-flex\"},[_c('div',{staticClass:\"heatmap--svg-container is-flex\"},[_c('svg',{ref:\"heatmapSvg\",staticClass:\"heatmap--svg\",attrs:{\"height\":_vm.chartHeight,\"width\":_vm.chartWidth}}),_c('barchart',{attrs:{\"type\":\"months\",\"vertical\":false,\"margin\":_vm.margin,\"chartData\":_vm.stats.month,\"barHeight\":_vm.barHeight,\"barWidth\":_vm.cellHeight,\"chartHeight\":_vm.chartWidth,\"selected\":_vm.selected}}),_c('div',{staticClass:\"selection--subtitle has-text-right\",style:({ 'padding-right': _vm.margin.right + 'px' })},[_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.selected.incidents > 0),expression:\"selected.incidents > 0\"}]},[_vm._v(\" \"+_vm._s(_vm.selected.incidents)+\" incidents selected \")])])],1),_c('div',[_c('barchart',{attrs:{\"type\":\"hours\",\"vertical\":true,\"margin\":_vm.margin,\"chartData\":_vm.stats.hour,\"barHeight\":_vm.cellHeight,\"barWidth\":_vm.barHeight,\"chartHeight\":_vm.chartHeight,\"selected\":_vm.selected}}),_c('svg',{ref:\"heatmapLegend\",staticClass:\"heatmap--legendsvg\",attrs:{\"height\":_vm.chartHeight,\"width\":_vm.legendWidth + _vm.legendMargin.left}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export const HOURS = [\r\n  \"12 am\",\r\n  \"1 am\",\r\n  \"2 am\",\r\n  \"3 am\",\r\n  \"4 am\",\r\n  \"5 am\",\r\n  \"6 am\",\r\n  \"7 am\",\r\n  \"8 am\",\r\n  \"9 am\",\r\n  \"10 am\",\r\n  \"11 am\",\r\n  \"12 pm\",\r\n  \"1 pm\",\r\n  \"2 pm\",\r\n  \"3 pm\",\r\n  \"4 pm\",\r\n  \"5 pm\",\r\n  \"6 pm\",\r\n  \"7 pm\",\r\n  \"8 pm\",\r\n  \"9 pm\",\r\n  \"10 pm\",\r\n  \"11 pm\"\r\n];\r\nexport const MONTHS = [\r\n  \"Jan\",\r\n  \"Feb\",\r\n  \"Mar\",\r\n  \"Apr\",\r\n  \"May\",\r\n  \"Jun\",\r\n  \"Jul\",\r\n  \"Aug\",\r\n  \"Sep\",\r\n  \"Oct\",\r\n  \"Nov\",\r\n  \"Dec\"\r\n];\r\n","import * as d3 from \"d3\";\r\n\r\nexport default {\r\n  toggleSpinner(domElement) {\r\n    let element = domElement.getElementsByClassName(\"fa\")[0] || domElement;\r\n    if (element) {\r\n      if (\r\n        element.classList.contains(\"fa-pulse\") &&\r\n        element.classList.contains(\"fa-spinner\")\r\n      ) {\r\n        element.classList.remove(\"fa-pulse\");\r\n        element.classList.replace(\"fa-spinner\", \"fa-refresh\");\r\n      } else if (element.classList.contains(\"fa-refresh\")) {\r\n        element.classList.replace(\"fa-refresh\", \"fa-spinner\");\r\n        element.classList.add(\"fa-pulse\");\r\n      }\r\n    }\r\n  },\r\n  scaleColor(p) {\r\n    return d3.color(d3.interpolateGreys(1 - p)).hex();\r\n  },\r\n  scaleColorSelection(p) {\r\n    return d3.color(d3.interpolateOranges(1 - p)).hex();\r\n  }\r\n};\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('svg',{ref:\"barchart\",staticClass:\"barchart\",attrs:{\"height\":_vm.height,\"width\":_vm.width}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <svg class=\"barchart\" ref=\"barchart\" :height=\"height\" :width=\"width\"></svg>\r\n</template>\r\n\r\n<script>\r\nimport { HOURS, MONTHS } from \"@/data/constants\";\r\nimport utils from \"@/utils\";\r\nimport * as d3 from \"d3\";\r\nexport default {\r\n  name: \"Barchart\",\r\n  props: [\r\n    \"margin\",\r\n    \"chartData\",\r\n    \"selected\",\r\n    \"vertical\",\r\n    \"type\",\r\n    \"barHeight\",\r\n    \"barWidth\",\r\n    \"chartHeight\"\r\n  ],\r\n  data() {\r\n    return {\r\n      barsData: undefined,\r\n      min: 1,\r\n      max: 1\r\n    };\r\n  },\r\n  computed: {\r\n    height() {\r\n      return this.vertical ? this.chartHeight : this.barHeight;\r\n    },\r\n    width() {\r\n      return this.vertical ? this.barWidth : this.chartHeight;\r\n    }\r\n  },\r\n  watch: {\r\n    chartData: {\r\n      deep: true,\r\n      handler() {\r\n        if (this.chartData.totals == null) return;\r\n        this.barsData = this.chartData.totals;\r\n        if (this.barsData == null || this.barsData.length == 0) return;\r\n\r\n        d3.select(this.$refs.barchart)\r\n          .selectAll(\"*\")\r\n          .remove();\r\n        let t = this.chartData.totals.map(d => d.total);\r\n        this.min = d3.min(t);\r\n        this.max = d3.max(t);\r\n        if (this.type == \"months\") {\r\n          this.updateBarChartHorizontal();\r\n        } else {\r\n          this.updateBarChartVertical();\r\n        }\r\n      }\r\n    },\r\n    selected: {\r\n      deep: true,\r\n      handler() {\r\n        let svg = d3.select(this.$refs.barchart);\r\n        svg\r\n          .selectAll(\".barchart__selected\")\r\n          .classed(\"barchart__selected\", false);\r\n        if (this.selected.type == \"month\") {\r\n          svg\r\n            .selectAll(\r\n              `.month-${this.selected.month}.year-${this.selected.year}`\r\n            )\r\n            .classed(\"barchart__selected\", true);\r\n        }\r\n        if (this.selected.type == \"hour\") {\r\n          svg\r\n            .selectAll(`.hour-${this.selected.hour}`)\r\n            .classed(\"barchart__selected\", true);\r\n        }\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    updateBarChartHorizontal() {\r\n      let svg = d3.select(this.$refs.barchart);\r\n      let chartG = svg.append(\"g\");\r\n      let $view = this;\r\n\r\n      chartG.attr(\"transform\", `translate(${this.margin.left}, 0)`);\r\n\r\n      chartG\r\n        .append(\"g\")\r\n        .selectAll(\".barchart__bars\")\r\n        .data(this.barsData)\r\n        .enter()\r\n        .append(\"rect\")\r\n        .attr(\"class\", d => `barchart__bars`)\r\n        .attr(\"x\", (d, i) => i * this.barWidth)\r\n        .attr(\"y\", 0)\r\n        .attr(\"height\", (d, i) => {\r\n          return this.barHeight * (d.total / this.max);\r\n        })\r\n        .attr(\"width\", this.barWidth)\r\n        .attr(\"stroke\", \"none\")\r\n        .attr(\"stroke-width\", \"0\")\r\n        .attr(\"fill\", (d, i) => {\r\n          let p = d.total / this.max;\r\n          return utils.scaleColor(0.2);\r\n        })\r\n        .attr(\"opacity\", 0.6)\r\n        .append(\"title\")\r\n        .text(d => `${d.total} incidents, ${d.key}`);\r\n      chartG\r\n        .append(\"g\")\r\n        .selectAll(\".barchart__ticks\")\r\n        .data(this.barsData)\r\n        .enter()\r\n        .append(\"rect\")\r\n        .attr(\"class\", d => `${d.class} barchart__ticks`)\r\n        .attr(\"x\", (d, i) => i * this.barWidth)\r\n        .attr(\"y\", (d, i) => {\r\n          return this.barHeight * (d.total / this.max) - 1.5;\r\n        })\r\n        .attr(\"height\", 1.5)\r\n        .attr(\"width\", this.barWidth)\r\n        .attr(\"stroke\", \"none\")\r\n        .attr(\"stroke-width\", \"0\")\r\n        .attr(\"fill\", (d, i) => {\r\n          let p = d.total / this.max;\r\n          return utils.scaleColor(0.6);\r\n        });\r\n    },\r\n    updateBarChartVertical() {\r\n      let svg = d3.select(this.$refs.barchart);\r\n      let chartG = svg.append(\"g\");\r\n      chartG.attr(\"transform\", `translate(0,${this.margin.top})`);\r\n      chartG\r\n        .append(\"g\")\r\n        .selectAll(\".barchart__bars\")\r\n        .data(this.barsData)\r\n        .enter()\r\n        .append(\"rect\")\r\n        .attr(\"class\", d => `barchart__bars`)\r\n        .attr(\"x\", 0)\r\n        .attr(\"y\", (d, i) => i * this.barHeight)\r\n        .attr(\"height\", this.barHeight)\r\n        .attr(\"width\", (d, i) => {\r\n          return this.barWidth * (d.total / this.max);\r\n        })\r\n        .attr(\"stroke\", \"none\")\r\n        .attr(\"stroke-width\", \"0\")\r\n        .attr(\"fill\", (d, i) => {\r\n          let p = d.total / this.max;\r\n          return utils.scaleColor(0.2);\r\n        })\r\n        .attr(\"opacity\", 0.6)\r\n        .append(\"title\")\r\n        .text(d => `${d.total} incidents at ${d.key}`);\r\n      chartG\r\n        .append(\"g\")\r\n        .selectAll(\".barchart__ticks\")\r\n        .data(this.barsData)\r\n        .enter()\r\n        .append(\"rect\")\r\n        .attr(\"class\", d => `${d.class} barchart__ticks`)\r\n        .attr(\"x\", (d, i) => {\r\n          return this.barWidth * (d.total / this.max) - 1.5;\r\n        })\r\n        .attr(\"y\", (d, i) => i * this.barHeight)\r\n        .attr(\"height\", this.barHeight)\r\n        .attr(\"width\", 1.5)\r\n        .attr(\"stroke\", \"none\")\r\n        .attr(\"stroke-width\", \"0\")\r\n        .attr(\"fill\", (d, i) => {\r\n          let p = d.total / this.max;\r\n          return utils.scaleColor(0.6);\r\n        });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.barchart {\r\n  &__bars:hover {\r\n    opacity: 1;\r\n  }\r\n  &__selected {\r\n    fill: #288be4;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Barchart.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Barchart.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Barchart.vue?vue&type=template&id=1cf3900a&\"\nimport script from \"./Barchart.vue?vue&type=script&lang=js&\"\nexport * from \"./Barchart.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Barchart.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"heatmap is-flex\" ref=\"heatmap\">\r\n    <div class=\"heatmap--svg-container is-flex\">\r\n      <svg\r\n        class=\"heatmap--svg\"\r\n        ref=\"heatmapSvg\"\r\n        :height=\"chartHeight\"\r\n        :width=\"chartWidth\"\r\n      ></svg>\r\n      <barchart\r\n        type=\"months\"\r\n        :vertical=\"false\"\r\n        :margin=\"margin\"\r\n        :chartData=\"stats.month\"\r\n        :barHeight=\"barHeight\"\r\n        :barWidth=\"cellHeight\"\r\n        :chartHeight=\"chartWidth\"\r\n        :selected=\"selected\"\r\n      >\r\n      </barchart>\r\n      <div\r\n        class=\"selection--subtitle has-text-right\"\r\n        :style=\"{ 'padding-right': margin.right + 'px' }\"\r\n      >\r\n        <span v-show=\"selected.incidents > 0\">\r\n          {{ selected.incidents }} incidents selected\r\n        </span>\r\n      </div>\r\n    </div>\r\n    <div>\r\n      <barchart\r\n        type=\"hours\"\r\n        :vertical=\"true\"\r\n        :margin=\"margin\"\r\n        :chartData=\"stats.hour\"\r\n        :barHeight=\"cellHeight\"\r\n        :barWidth=\"barHeight\"\r\n        :chartHeight=\"chartHeight\"\r\n        :selected=\"selected\"\r\n      >\r\n      </barchart>\r\n      <svg\r\n        class=\"heatmap--legendsvg\"\r\n        ref=\"heatmapLegend\"\r\n        :height=\"chartHeight\"\r\n        :width=\"legendWidth + legendMargin.left\"\r\n      ></svg>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { HOURS, MONTHS } from \"@/data/constants\";\r\nimport utils from \"@/utils\";\r\nimport * as d3 from \"d3\";\r\nimport Barchart from \"@/components/Barchart\";\r\nexport default {\r\n  name: \"heatmap\",\r\n  props: [\"allIncidents\", \"boxSelectedIncidents\", \"incidentType\"],\r\n  components: { Barchart },\r\n  data() {\r\n    return {\r\n      cellWidth: 15,\r\n      cellHeight: 15,\r\n      barHeight: 30,\r\n\r\n      margin: {\r\n        bottom: 2,\r\n        top: 50,\r\n        left: 50,\r\n        right: 5\r\n      },\r\n\r\n      legendWidth: 60,\r\n      legendMargin: {\r\n        top: 60,\r\n        left: 8\r\n      },\r\n\r\n      chart: {\r\n        sizeScale: undefined\r\n      },\r\n\r\n      incidents: undefined,\r\n      nested: undefined,\r\n\r\n      years: [],\r\n      months: MONTHS,\r\n      hours: HOURS,\r\n\r\n      stats: {\r\n        year: {\r\n          min: Infinity,\r\n          max: -Infinity,\r\n          totals: undefined\r\n        },\r\n        month: {\r\n          min: Infinity,\r\n          max: -Infinity,\r\n          totals: undefined\r\n        },\r\n        hour: {\r\n          min: Infinity,\r\n          max: -Infinity,\r\n          totals: undefined\r\n        }\r\n      },\r\n\r\n      selected: {\r\n        hour: undefined,\r\n        month: undefined,\r\n        year: undefined,\r\n        type: undefined,\r\n        incidents: undefined\r\n      }\r\n    };\r\n  },\r\n  watch: {\r\n    allIncidents() {\r\n      this.filterAndProcessIncidents();\r\n      this.years.push(...this.nested.map(d => d.key));\r\n      this.clearChart();\r\n      this.updateChart();\r\n    },\r\n    incidentType() {\r\n      this.selected.hour = undefined;\r\n      this.selected.month = undefined;\r\n      this.selected.year = undefined;\r\n      this.selected.type = undefined;\r\n      this.selected.incidents = 0;\r\n      this.filterAndProcessIncidents();\r\n      this.clearChart();\r\n      this.updateChart();\r\n    },\r\n    boxSelectedIncidents() {\r\n      //this.showBoxSelectedIncidents();\r\n    }\r\n  },\r\n  computed: {\r\n    height() {\r\n      return this.cellHeight * this.hours.length;\r\n    },\r\n    chartHeight() {\r\n      return this.height + this.margin.top + this.margin.bottom;\r\n    },\r\n    width() {\r\n      return this.years.length * this.months.length * this.cellWidth;\r\n    },\r\n    chartWidth() {\r\n      return this.width + this.margin.left + this.margin.right;\r\n    },\r\n    legendHeight() {\r\n      return this.cellHeight * 1.5;\r\n    }\r\n  },\r\n  methods: {\r\n    clearChart() {\r\n      d3.select(this.$refs.heatmapSvg)\r\n        .selectAll(\"*\")\r\n        .remove();\r\n      d3.select(this.$refs.heatmapLegend)\r\n        .selectAll(\"*\")\r\n        .remove();\r\n\r\n      this.$refs.heatmap.classList.remove(\"heatmap__visible\");\r\n    },\r\n    filterAndProcessIncidents() {\r\n      let filtered = this.allIncidents.filter(d => {\r\n        return d.mode_type == this.incidentType || this.incidentType == \"*\";\r\n      });\r\n\r\n      this.nested = d3\r\n        .nest()\r\n        .key(d => d.year)\r\n        .key(d => d.month)\r\n        .sortKeys((a, b) => a - b)\r\n        .key(d => d.hour)\r\n        .sortKeys((a, b) => a - b)\r\n        .entries(filtered);\r\n\r\n      this.nested.forEach(year => {\r\n        let ytotal = 0;\r\n        year.values.forEach(month => {\r\n          let mtotal = 0;\r\n          month.values.forEach(hour => {\r\n            let htotal = hour.values.length;\r\n            this.stats.hour.min = Math.min(htotal, this.stats.hour.min);\r\n            this.stats.hour.max = Math.max(htotal, this.stats.hour.max);\r\n            hour.total = htotal;\r\n            mtotal = mtotal + htotal;\r\n          });\r\n          month.total = mtotal;\r\n          ytotal = ytotal + mtotal;\r\n          this.stats.month.min = Math.min(mtotal, this.stats.month.min);\r\n          this.stats.month.max = Math.max(mtotal, this.stats.month.max);\r\n        });\r\n        year.total = ytotal;\r\n        this.stats.year.min = Math.min(ytotal, this.stats.year.min);\r\n        this.stats.year.max = Math.max(ytotal, this.stats.year.max);\r\n      });\r\n      this.incidents = filtered;\r\n\r\n      // compute total by hours\r\n      let totalByHour = HOURS.map((h, i) => ({\r\n        key: h,\r\n        hour: i,\r\n        class: `hour-total hour-${i}`,\r\n        total: 0\r\n      }));\r\n\r\n      // compute total by month\r\n      let totalsByMonth = this.nested.map(year => {\r\n        return year.values.map(month => {\r\n          let monthKey = MONTHS[+month.key];\r\n\r\n          month.values.forEach(hour => {\r\n            totalByHour[+hour.key].total += hour.total;\r\n          });\r\n\r\n          return {\r\n            year: year.key,\r\n            month: month.key,\r\n            key: `${monthKey} ${year.key}`,\r\n            class: `month-total month-${month.key} year-${year.key}`,\r\n            total: month.total\r\n          };\r\n        });\r\n      });\r\n\r\n      // compute total by years\r\n      let totalsByYear = this.nested.map(year => ({\r\n        year: year.key,\r\n        key: `${year.key}`,\r\n        class: `year-total year-${year.key}`,\r\n        total: year.total\r\n      }));\r\n\r\n      // update stats\r\n      this.$set(this.stats.year, \"totals\", totalsByYear.flat());\r\n      this.$set(this.stats.month, \"totals\", totalsByMonth.flat());\r\n      this.$set(this.stats.hour, \"totals\", totalByHour.flat());\r\n    },\r\n    selectByHour(hour) {\r\n      this.selected.year = undefined;\r\n      this.selected.month = undefined;\r\n      this.selected.hour = hour;\r\n      this.selected.type = \"hour\";\r\n      let selected = [];\r\n      this.nested.forEach(year => {\r\n        year.values.forEach(month => {\r\n          if (month.values[this.selected.hour])\r\n            selected.push(...month.values[this.selected.hour].values);\r\n        });\r\n      });\r\n      this.selected.incidents = this.stats.hour.totals[hour].total;\r\n      this.$emit(\"selected\", { selected, type: \"hour\" });\r\n    },\r\n    selectByMonth(year, month) {\r\n      this.selected.year = year;\r\n      this.selected.month = +month.key;\r\n      this.selected.hour = undefined;\r\n      this.selected.type = \"month\";\r\n      let selected = [];\r\n      month.values.forEach(hour => {\r\n        selected.push(...hour.values);\r\n      });\r\n      this.selected.incidents = selected.length;\r\n      this.selected.incidents = this.stats.month.totals[\r\n        this.selected.month\r\n      ].total;\r\n      this.$emit(\"selected\", { selected, type: \"month\" });\r\n    },\r\n    createScale() {\r\n      this.chart.sizeScale = d3\r\n        .scaleSqrt()\r\n        .domain([0, this.stats.hour.max])\r\n        .range([0, (this.cellWidth - 1) * 0.5]);\r\n    },\r\n    updateChart() {\r\n      // size scale\r\n      let $view = this;\r\n      this.createScale();\r\n      let svg = d3.select(this.$refs.heatmapSvg);\r\n      let chartG = svg\r\n        .append(\"g\")\r\n        .attr(\"class\", \"heatmap--chart\")\r\n        .attr(\"transform\", `translate(${this.margin.left},${this.margin.top})`);\r\n      let yearLabelsG = svg\r\n        .append(\"g\")\r\n        .attr(\"class\", \"heatmap--year-labels labels\");\r\n      let hourLabelsG = svg\r\n        .append(\"g\")\r\n        .attr(\"transform\", `translate(0,${this.margin.top})`)\r\n        .attr(\"class\", \"heatmap--hour-labels labels\")\r\n        .selectAll(\"text\")\r\n        .data(this.hours)\r\n        .enter()\r\n        .append(\"text\")\r\n        .attr(\"height\", this.cellHeight)\r\n        .attr(\"width\", this.cellWidth)\r\n        .attr(\"class\", \"heatmap--hour-label labels\")\r\n        .attr(\"alignment-baseline\", \"middle\")\r\n        .style(\"text-anchor\", \"end\")\r\n        .attr(\"transform\", (d, i) => {\r\n          let x = this.margin.left - 6;\r\n          let y = this.cellHeight * (i + 1) - this.cellHeight / 2.0;\r\n          return `translate(${x},${y})`;\r\n        })\r\n        .style(\"font-weight\", \"100\")\r\n        .style(\"font-size\", \"12px\")\r\n        .style(\"text-align\", \"left\")\r\n        .style(\"fill\", \"#aaa\")\r\n        .text(d => d)\r\n        .on(\"click\", function(d, i) {\r\n          chartG.selectAll(\".hour__selected\").classed(\"hour__selected\", false);\r\n          chartG.selectAll(`.hour-${i}`).classed(\"hour__selected\", true);\r\n          svg.selectAll(\".label__selected\").classed(\"label__selected\", false);\r\n          d3.select(this).classed(\"label__selected\", true);\r\n          $view.selectByHour(i);\r\n        });\r\n\r\n      let yearColumnCenter = (12 * this.cellWidth) / 2;\r\n\r\n      // three level nesting, year -> month -> hour\r\n      this.nested.forEach((year, y) => {\r\n        let yx = y * 12 * this.cellWidth;\r\n        let ygroup = chartG\r\n          .append(\"g\")\r\n          .attr(\"class\", d => `year year-${year.key}`)\r\n          .attr(\"class\", \"year\")\r\n          .attr(\"transform\", `translate(${yx},0)`);\r\n        ygroup\r\n          .append(\"text\")\r\n          .attr(\"class\", \"heatmap--year-label label\")\r\n          .attr(\"transform\", `translate(${yearColumnCenter},-40)`)\r\n          .style(\"font-weight\", \"100\")\r\n          .style(\"font-size\", \"16px\")\r\n          .style(\"text-align\", \"center\")\r\n          .style(\"fill\", \"#aaa\")\r\n          .attr(\"alignment-baseline\", \"middle\")\r\n          .style(\"text-anchor\", \"middle\")\r\n          .text(year.key)\r\n          .append(\"title\")\r\n          .text(`Incidents from year ${year.key}`);\r\n        ygroup\r\n          .append(\"rect\")\r\n          .attr(\"class\", \"heatmap--column-sep\")\r\n          .attr(\"transform\", `translate(${yearColumnCenter * 2},-20)`)\r\n          .attr(\"width\", \".25\")\r\n          .attr(\"height\", this.height + 20)\r\n          .style(\"fill\", \"#aaa\")\r\n          .style(\"opacity\", 0.9);\r\n\r\n        year.values.forEach((month, m) => {\r\n          let mx = m * this.cellWidth;\r\n          let mgroup = ygroup\r\n            .append(\"g\")\r\n            .attr(\"class\", d => `month month-${month.key}`)\r\n            .attr(\"transform\", `translate(${mx},0)`);\r\n          mgroup\r\n            .append(\"text\")\r\n            .attr(\"class\", \"heatmap--month-label label\")\r\n            .attr(\"transform\", `translate(${this.cellWidth / 2},${-10})`)\r\n            .style(\"font-weight\", \"100\")\r\n            .style(\"font-size\", \"11px\")\r\n            .attr(\"alignment-baseline\", \"middle\")\r\n            .style(\"text-anchor\", \"middle\")\r\n            .style(\"fill\", \"#aaa\")\r\n            .text(month.key)\r\n            .on(\"click\", function(d, i) {\r\n              chartG\r\n                .selectAll(\".hour__selected\")\r\n                .classed(\"hour__selected\", false);\r\n              mgroup.selectAll(`.hour`).classed(\"hour__selected\", true);\r\n              svg\r\n                .selectAll(\".label__selected\")\r\n                .classed(\"label__selected\", false);\r\n              d3.select(this).classed(\"label__selected\", true);\r\n              $view.selectByMonth(year.key, month);\r\n            });\r\n\r\n          month.values.forEach((hour, h) => {\r\n            let hourKey = +hour.key;\r\n            let total = hour.values.length;\r\n            let p = Math.max(0.3, total / this.stats.hour.max);\r\n            //let clr = d3.color(d3.interpolateGreys(1 - p)).hex();\r\n            let clr = utils.scaleColor(p);\r\n            // let clr = d3.color(d3.interpolateOranges(1 - p)).hex();\r\n            let rsize = this.chart.sizeScale(total);\r\n            mgroup\r\n              .append(\"circle\")\r\n              .attr(\"class\", d => `hour hour-${hour.key}`)\r\n              .attr(\"cx\", this.cellWidth / 2.0)\r\n              .attr(\"cy\", hourKey * this.cellHeight + this.cellHeight / 2)\r\n              .attr(\"r\", rsize)\r\n              .attr(\"fill\", clr)\r\n              .attr(\"opacity\", 0.6)\r\n              .attr(\"stroke\", \"none\")\r\n              .on(\"mouseover\", function(d, i) {\r\n                d3.select(this).classed(\"hour__hovered\", true);\r\n              })\r\n              .on(\"mouseout\", function(d, i) {\r\n                d3.select(this).classed(\"hour__hovered\", false);\r\n              })\r\n              .on(\"click\", function(d, i) {\r\n                svg\r\n                  .selectAll(\".label__selected\")\r\n                  .classed(\"label__selected\", false);\r\n                svg\r\n                  .selectAll(\".hour__selected\")\r\n                  .classed(\"hour__selected\", false);\r\n                d3.select(this).classed(\"hour__selected\", true);\r\n                $view.$emit(\"selected\", {\r\n                  selected: hour.values,\r\n                  type: \"single\"\r\n                });\r\n                $view.selected.incidents = hour.values.length;\r\n              })\r\n              .append(\"title\")\r\n              .text(\r\n                `${total} incidents at ${this.hours[hour.key]} in ${\r\n                  this.months[month.key]\r\n                } ${year.key}`\r\n              );\r\n          });\r\n        });\r\n      });\r\n      this.updateLegend();\r\n\r\n      if (!this.$refs.heatmap.classList.contains(\"heatmap__visible\")) {\r\n        this.$refs.heatmap.classList.add(\"heatmap__visible\");\r\n      }\r\n    },\r\n\r\n    showBoxSelectedIncidents() {\r\n      this.createScale();\r\n      let nested = d3\r\n        .nest()\r\n        .key(d => d.year)\r\n        .key(d => d.month)\r\n        .sortKeys((a, b) => a - b)\r\n        .key(d => d.hour)\r\n        .sortKeys((a, b) => a - b)\r\n        .entries(this.boxSelectedIncidents);\r\n\r\n      // size scale\r\n      let svg = d3.select(this.$refs.heatmapSvg);\r\n      svg.select(\".heatmap--selected\").remove();\r\n      let selectionG = svg\r\n        .append(\"g\")\r\n        .attr(\"class\", \"heatmap--selected\")\r\n        .attr(\"transform\", `translate(${this.margin.left},${this.margin.top})`);\r\n\r\n      let clr = \"hsl(348, 100%, 61%)\";\r\n      // three level nesting, year -> month -> hour\r\n      nested.forEach((year, y) => {\r\n        let yx = y * 12 * this.cellWidth;\r\n        let ygroup = selectionG\r\n          .append(\"g\")\r\n          .attr(\"class\", d => `year year-${year.key}`)\r\n          .attr(\"class\", \"year\")\r\n          .attr(\"transform\", `translate(${yx},0)`);\r\n        year.values.forEach((month, m) => {\r\n          let mx = m * this.cellWidth;\r\n          let mgroup = ygroup\r\n            .append(\"g\")\r\n            .attr(\"class\", d => `month month-${month.key}`)\r\n            .attr(\"transform\", `translate(${mx},0)`);\r\n          month.values.forEach((hour, h) => {\r\n            let hourKey = +hour.key;\r\n            let total = hour.values.length;\r\n            let p = Math.max(0.3, total / this.stats.hour.max);\r\n            let rsize = this.chart.sizeScale(total);\r\n            mgroup\r\n              .append(\"circle\")\r\n              .attr(\"class\", d => `hour hour-${hour.key}`)\r\n              .attr(\"cx\", this.cellWidth / 2.0)\r\n              .attr(\"cy\", hourKey * this.cellHeight + this.cellHeight / 2)\r\n              .attr(\"r\", rsize)\r\n              .attr(\"fill\", clr)\r\n              .attr(\"opacity\", 1)\r\n              .attr(\"stroke\", clr)\r\n              .append(\"title\")\r\n              .text(\r\n                `${total} incidents at ${this.hours[h]} in ${this.months[m]} ${year.key}`\r\n              );\r\n          });\r\n        });\r\n      });\r\n    },\r\n\r\n    updateLegend() {\r\n      let ticks = d3\r\n        .scaleLinear()\r\n        .domain([0, this.stats.hour.max])\r\n        .nice()\r\n        .ticks(5);\r\n\r\n      if (ticks[0] < 5) ticks[0] = this.stats.hour.min;\r\n\r\n      let svg = d3.select(this.$refs.heatmapLegend);\r\n\r\n      let leftMargin = this.legendMargin.left;\r\n      let topMargin = this.legendMargin.top + this.cellHeight * 2.25;\r\n      let rowHeight = this.cellHeight * 1.25;\r\n\r\n      let title = svg\r\n        .append(\"text\")\r\n        .attr(\"class\", d => `legendTitle`)\r\n        .attr(\"x\", leftMargin)\r\n        .attr(\"y\", (d, i) => this.legendMargin.top)\r\n        .style(\"font-weight\", \"100\")\r\n        .style(\"font-size\", \"11px\")\r\n        .attr(\"alignment-baseline\", \"middle\")\r\n        .style(\"text-anchor\", \"left\")\r\n        .style(\"fill\", \"#aaa\")\r\n        .text(\"\");\r\n      title\r\n        .append(\"tspan\")\r\n        .attr(\"x\", leftMargin)\r\n        .attr(\"y\", (d, i) => this.legendMargin.top)\r\n        .text(\"# of\");\r\n      title\r\n        .append(\"tspan\")\r\n        .attr(\"x\", leftMargin)\r\n        .attr(\"y\", (d, i) => this.legendMargin.top + this.cellHeight)\r\n        .text(\"Incidents\");\r\n\r\n      let g = svg.append(\"g\");\r\n      g.selectAll(\".legendDots\")\r\n        .data(ticks)\r\n        .enter()\r\n        .append(\"circle\")\r\n        .attr(\"class\", d => `legendDots legend-${d}`)\r\n        .attr(\"cx\", leftMargin + 10)\r\n        .attr(\"cy\", (d, i) => topMargin + rowHeight * i)\r\n        .attr(\"r\", d => this.chart.sizeScale(d))\r\n        .attr(\"fill\", d =>\r\n          utils.scaleColor(Math.max(0.3, d / this.stats.hour.max))\r\n        )\r\n        .attr(\"opacity\", 0.6)\r\n        .attr(\"stroke\", \"none\");\r\n      g.selectAll(\".legendLabels\")\r\n        .data(ticks)\r\n        .enter()\r\n        .append(\"text\")\r\n        .attr(\"class\", d => `legendLabels legend-${d}`)\r\n        .attr(\"x\", leftMargin + 10 + this.cellWidth)\r\n        .attr(\"y\", (d, i) => topMargin + rowHeight * i)\r\n        .style(\"font-weight\", \"100\")\r\n        .style(\"font-size\", \"11px\")\r\n        .attr(\"alignment-baseline\", \"middle\")\r\n        .style(\"text-anchor\", \"left\")\r\n        .style(\"fill\", \"#aaa\")\r\n        .attr(\"opacity\", 0.6)\r\n        .text(d => d);\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.heatmap {\r\n  display: flex;\r\n  flex-direction: row;\r\n  flex: 0;\r\n\r\n  opacity: 0;\r\n  transition: opacity 1s;\r\n  margin-top: 45px;\r\n\r\n  &__visible {\r\n    opacity: 1;\r\n  }\r\n  &--hour-label,\r\n  &--month-label,\r\n  &--year-label {\r\n    cursor: pointer;\r\n    user-select: none;\r\n  }\r\n  &--svg-container {\r\n    flex-direction: column;\r\n  }\r\n}\r\n.hour {\r\n  &__selected,\r\n  &__hovered {\r\n    stroke: #288be4;\r\n    stroke-width: 1.75;\r\n    opacity: 1;\r\n  }\r\n}\r\n.label__selected {\r\n  fill: #288be4 !important;\r\n}\r\n.selection--subtitle {\r\n  padding-top: 1rem;\r\n  height: 40px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Heatmap.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Heatmap.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Heatmap.vue?vue&type=template&id=521bd8ee&\"\nimport script from \"./Heatmap.vue?vue&type=script&lang=js&\"\nexport * from \"./Heatmap.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Heatmap.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"stackedbar--container\"},[_c('div',{staticClass:\"stackedbar--title\"}),_c('svg',{ref:\"stackedbar\",staticClass:\"stackedbar\",attrs:{\"height\":_vm.chartHeight,\"width\":_vm.chartWidth}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"stackedbar--container\">\r\n    <div class=\"stackedbar--title\"></div>\r\n    <svg\r\n      class=\"stackedbar\"\r\n      ref=\"stackedbar\"\r\n      :height=\"chartHeight\"\r\n      :width=\"chartWidth\"\r\n    ></svg>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { HOURS, MONTHS } from \"@/data/constants\";\r\nimport utils from \"@/utils\";\r\nimport * as d3 from \"d3\";\r\nexport default {\r\n  name: \"stackedbar\",\r\n  props: [\"chartData\", \"selected\", \"width\", \"height\", \"title\"],\r\n  data() {\r\n    return {\r\n      margin: {\r\n        bottom: 30,\r\n        top: 10,\r\n        left: 10,\r\n        right: 10\r\n      }\r\n    };\r\n  },\r\n  computed: {\r\n    chartHeight() {\r\n      return +this.height + this.margin.top + this.margin.bottom;\r\n    },\r\n    chartWidth() {\r\n      return +this.width + this.margin.left + this.margin.right;\r\n    }\r\n  },\r\n  watch: {\r\n    chartData: {\r\n      deep: true,\r\n      handler() {\r\n        this.updateBarChart();\r\n        console.log(this.chartData);\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    updateBarChart() {\r\n      let svg = d3.select(this.$refs.stackedbar);\r\n\r\n      let chartG = svg\r\n        .append(\"g\")\r\n        .attr(\r\n          \"transform\",\r\n          `translate(${this.margin.left}, ${this.margin.top})`\r\n        );\r\n\r\n      let series = d3\r\n        .stack()\r\n        .keys(this.chartData.columns)(this.chartData)\r\n        .map(d => (d.forEach(v => (v.key = d.key)), d));\r\n\r\n      let x = d3\r\n        .scaleBand()\r\n        .domain(this.chartData.map(d => d.name))\r\n        .range([this.margin.left, this.width - this.margin.right])\r\n        .padding(0.1);\r\n\r\n      let y = d3\r\n        .scaleLinear()\r\n        .domain([0, d3.max(series, d => d3.max(d, d => d[1]))])\r\n        .rangeRound([this.height - this.margin.bottom, this.margin.top]);\r\n      let color = d3\r\n        .scaleOrdinal()\r\n        .range([\r\n          utils.scaleColor(0.3),\r\n          utils.scaleColor(0.4),\r\n          utils.scaleColor(0.5)\r\n        ])\r\n        .domain(this.chartData.columns);\r\n\r\n      let bars = chartG\r\n        .append(\"g\")\r\n        .selectAll(\"g\")\r\n        .data(series);\r\n      bars\r\n        .join(\"g\")\r\n        .attr(\"stroke\", d => color(d.key))\r\n        .attr(\"stroke-width\", \".5\")\r\n        .attr(\"fill\", d => color(d.key))\r\n        .attr(\"opacity\", 0.5)\r\n        .selectAll(\"rect\")\r\n        .data(d => d)\r\n        .join(\"rect\")\r\n        .attr(\"x\", (d, i) => x(d.data.name))\r\n        .attr(\"y\", (d, i) => y(d[1]))\r\n        .attr(\"height\", d => y(d[0]) - y(d[1]))\r\n        .attr(\"width\", x.bandwidth())\r\n        .append(\"title\")\r\n        .text(d => {\r\n          console.log(d);\r\n          let n = d[1] - d[0];\r\n          let title = this.chartData.titles[d.key];\r\n          return `${n} ${title} incidents in ${d.data.name}`;\r\n        });\r\n\r\n      let xAxis = svg\r\n        .append(\"g\")\r\n        .attr(\r\n          \"transform\",\r\n          `translate(${this.margin.left},${this.height - this.margin.top})`\r\n        )\r\n        .call(d3.axisBottom(x).tickSizeOuter(0));\r\n      xAxis.selectAll(\"line\").remove();\r\n      xAxis.selectAll(\"path\").remove();\r\n      xAxis\r\n        .selectAll(\"text\")\r\n        .attr(\"alignment-baseline\", \"middle\")\r\n        .style(\"text-anchor\", \"end\")\r\n        .style(\"font-size\", \"14px\")\r\n        .style(\"font-family\", \"Montserrat\")\r\n        .style(\"font-weight\", \"100\")\r\n        .attr(\"dy\", \"-7px\")\r\n        .style(\"user-select\", \"none\")\r\n        .attr(\"transform\", \"rotate(-90)\");\r\n\r\n      let barLabels = chartG\r\n        .append(\"g\")\r\n        .selectAll(\".bar--label\")\r\n        .data(this.chartData)\r\n        .enter()\r\n        .append(\"text\")\r\n        .attr(\"class\", \"bar--label\")\r\n        .attr(\"y\", d => y(d.total) - 10)\r\n        .attr(\"x\", d => x(d.name))\r\n        .style(\"font-size\", \"12px\")\r\n        .style(\"font-family\", \"Montserrat\")\r\n        .style(\"font-weight\", \"100\")\r\n        .attr(\"fill\", utils.scaleColor(0.7))\r\n        .attr(\"opacity\", 0.5)\r\n        .text(d => d.total);\r\n    },\r\n\r\n    updateBarChartH() {\r\n      let svg = d3.select(this.$refs.stackedbar);\r\n\r\n      let chartG = svg\r\n        .append(\"g\")\r\n        .attr(\r\n          \"transform\",\r\n          `translate(${this.margin.left}, ${this.margin.top})`\r\n        );\r\n\r\n      let series = d3\r\n        .stack()\r\n        .keys(this.chartData.columns)(this.chartData)\r\n        .map(d => (d.forEach(v => (v.key = d.key)), d));\r\n\r\n      let x = d3\r\n        .scaleLinear()\r\n        .domain([0, d3.max(series, d => d3.max(d, d => d[1]))])\r\n        .rangeRound([this.width - this.margin.left, this.margin.right]);\r\n\r\n      let y = d3\r\n        .scaleBand()\r\n        .domain(this.chartData.map(d => d.name))\r\n        .range([this.margin.top, this.height - this.margin.bottom])\r\n        .padding(0.1);\r\n\r\n      var color = d3\r\n        .scaleOrdinal()\r\n        .range([\r\n          utils.scaleColor(0.3),\r\n          utils.scaleColor(0.4),\r\n          utils.scaleColor(0.5)\r\n        ])\r\n        .domain(this.chartData.columns);\r\n\r\n      chartG\r\n        .append(\"g\")\r\n        .selectAll(\"g\")\r\n        .data(series)\r\n        .join(\"g\")\r\n        .attr(\"stroke\", d => color(d.key))\r\n        .attr(\"stroke-width\", \".5\")\r\n        .attr(\"fill\", d => color(d.key))\r\n        .attr(\"opacity\", 0.5)\r\n        .selectAll(\"rect\")\r\n        .data(d => d)\r\n        .join(\"rect\")\r\n        .attr(\"x\", (d, i) => x(d[1]))\r\n        .attr(\"y\", (d, i) => y(d.data.name))\r\n        .attr(\"width\", d => x(d[0]) - x(d[1]))\r\n        .attr(\"height\", y.bandwidth())\r\n        .append(\"title\")\r\n        .text(d => `${d.data.name} ${d.key}`);\r\n\r\n      let xAxis = svg\r\n        .append(\"g\")\r\n        .attr(\r\n          \"transform\",\r\n          `translate(${this.margin.left},${this.height - this.margin.top})`\r\n        )\r\n        .call(d3.axisLeft(y).tickSizeOuter(0));\r\n      xAxis.selectAll(\"line\").remove();\r\n      xAxis.selectAll(\"path\").remove();\r\n      xAxis\r\n        .selectAll(\"text\")\r\n        .attr(\"alignment-baseline\", \"middle\")\r\n        .style(\"text-anchor\", \"end\")\r\n        .style(\"font-size\", \"14px\")\r\n        .style(\"font-family\", \"Montserrat\")\r\n        .style(\"font-weight\", \"100\")\r\n        .attr(\"dy\", \"-7px\")\r\n        .style(\"user-select\", \"none\")\r\n        .attr(\"transform\", \"rotate(-90)\");\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style></style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stackedbar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Stackedbar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Stackedbar.vue?vue&type=template&id=63327956&\"\nimport script from \"./Stackedbar.vue?vue&type=script&lang=js&\"\nexport * from \"./Stackedbar.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"mapvis--container\">\r\n    <div class=\"mapvis\" ref=\"mapvis\">\r\n      <div class=\"mapvis--title subtitle\" v-if=\"numBoxSelectedIncidents > 0\">\r\n        {{ numBoxSelectedIncidents }} incidents\r\n      </div>\r\n      <svg\r\n        class=\"mapvis--svg\"\r\n        ref=\"mapSvg\"\r\n        :height=\"height\"\r\n        :width=\"width - rightClip\"\r\n      ></svg>\r\n      <canvas\r\n        class=\"mapvis--canvas\"\r\n        ref=\"mapCanvas\"\r\n        :height=\"height\"\r\n        :width=\"width - rightClip\"\r\n      ></canvas>\r\n      <svg\r\n        class=\"mapvis--canvas__selection mapvis--canvas__selectionsvg\"\r\n        ref=\"mapSvgSelection\"\r\n        :height=\"height\"\r\n        :width=\"width - rightClip\"\r\n      ></svg>\r\n      <canvas\r\n        class=\"mapvis--canvas__selection\"\r\n        ref=\"mapCanvasSelection\"\r\n        :height=\"height\"\r\n        :width=\"width - rightClip\"\r\n      ></canvas>\r\n    </div>\r\n    <div class=\"sumvis--container\">\r\n      <heatmap\r\n        :allIncidents=\"allIncidents\"\r\n        :boxSelectedIncidents=\"boxSelectedIncidents\"\r\n        :incidentType=\"incidentType\"\r\n        @selected=\"updateSelection\"\r\n      >\r\n      </heatmap>\r\n      <div class=\"sumvis--summary\">\r\n        <stackedbar\r\n          :chartData=\"allSummary.yearly\"\r\n          :width=\"170\"\r\n          :height=\"220\"\r\n          title=\"All\"\r\n        >\r\n        </stackedbar>\r\n        <article class=\"sumvis--description is-half\">\r\n          <p>\r\n            Vision Zero is a multi-national initiative that aims to eliminate\r\n            serious or fatal traffic incidents by 2030. This visualization shows\r\n            all the serious incidents that occurred in Boston, MA\r\n            {{ yearRange }} using the data provided by\r\n            <a href=\"https://data.boston.gov/dataset/vision-zero-crash-records\"\r\n              >data.boston.gov</a\r\n            >.\r\n          </p>\r\n          <br />\r\n          <p>\r\n            This interactive visualization capability shows geographic and\r\n            temporal hotspots where many of these incidents occur.\r\n          </p>\r\n          <br />\r\n          <p>\r\n            Using the incident type filter, places where serious incidents\r\n            involving pedestrian or bicycle can be focused on. Using the\r\n            calendar chart, incidents that occure at certain hour, in certain\r\n            month, or at certain hour across all years can be highlighted in the\r\n            map view.\r\n          </p>\r\n          <br />\r\n        </article>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as d3 from \"d3\";\r\nimport d3hexgrid from \"d3-hexgrid\";\r\nimport topojson from \"topojson\";\r\nimport simpleheat from \"simpleheat\";\r\nimport Heatmap from \"@/components/Heatmap.vue\";\r\nimport Stackedbar from \"@/components/Stackedbar\";\r\n\r\nexport default {\r\n  name: \"GeoHeatmap\",\r\n  components: { Heatmap, Stackedbar },\r\n  props: [\r\n    \"neighborhoods\",\r\n    \"stations\",\r\n    \"allIncidents\",\r\n    \"allSummary\",\r\n    \"year\",\r\n    \"month\",\r\n    \"incidentType\"\r\n  ],\r\n  data() {\r\n    return {\r\n      height: 900,\r\n      width: 1000,\r\n      rightClip: 220,\r\n\r\n      heatmapData: undefined,\r\n\r\n      projection: undefined,\r\n      path: undefined,\r\n\r\n      incidents: undefined,\r\n      quadtree: undefined,\r\n\r\n      boxSelectedIncidents: [],\r\n      numBoxSelectedIncidents: 0,\r\n\r\n      hover: {\r\n        x: 0,\r\n        y: 0,\r\n        r: 10\r\n      },\r\n\r\n      refreshing: false,\r\n\r\n      selectedIncidents: []\r\n    };\r\n  },\r\n  computed: {\r\n    yearRange() {\r\n      if (this.allSummary && this.allSummary.yearly) {\r\n        return `from ${this.allSummary.yearly[0].name} to ${\r\n          this.allSummary.yearly[this.allSummary.yearly.length - 1].name\r\n        }`;\r\n      }\r\n      return \"from 2015 to 2020\";\r\n    }\r\n  },\r\n  watch: {\r\n    neighborhoods() {\r\n      this.createMapVis();\r\n    },\r\n    stations() {\r\n      //this.updateStations();\r\n    },\r\n    allIncidents() {\r\n      this.convertData();\r\n      this.processAndFilterData();\r\n    },\r\n    incidentType() {\r\n      this.processAndFilterData();\r\n      this.selectedIncidents = [];\r\n      this.updateSelectionSvg();\r\n      this.updateSelectionCanvas();\r\n      this.updateHeatMap();\r\n    },\r\n    year() {\r\n      this.updateHeatMap();\r\n    },\r\n    month() {\r\n      this.updateHeatMap();\r\n    },\r\n    hover: {\r\n      deep: true,\r\n      handler() {\r\n        this.moveHoverBox();\r\n        this.updateHoverSelection();\r\n      }\r\n    },\r\n    heatmapData() {\r\n      this.updateHoverSelection();\r\n    }\r\n  },\r\n  methods: {\r\n    createMapVis() {\r\n      this.projection = d3\r\n        .geoMercator()\r\n        .precision(0.1)\r\n        .translate([this.width / 2, this.height / 2])\r\n        .fitExtent(\r\n          [\r\n            [0, 0],\r\n            [this.width, this.height]\r\n          ],\r\n          this.neighborhoods\r\n        );\r\n      this.path = d3.geoPath().projection(this.projection);\r\n      let mapLayer = d3.select(this.$refs.mapSvg);\r\n      mapLayer\r\n        .append(\"g\")\r\n        .selectAll(\".boundary\")\r\n        .data(this.neighborhoods.features)\r\n        .enter()\r\n        .append(\"path\")\r\n        .attr(\"class\", \"boundary\")\r\n        .attr(\"d\", this.path)\r\n        .attr(\"stroke\", \"#fff\")\r\n        .attr(\"stroke-width\", \".2\")\r\n        .attr(\"stroke-opacity\", \".8\")\r\n        .style(\"fill\", \"#222\") //\"#abc\")\r\n        .attr(\"title\", d => d.properties.NEIGHBORHOOD);\r\n\r\n      let hoverbox = mapLayer\r\n        .append(\"rect\")\r\n        .attr(\"class\", \"hoverbox\")\r\n        .style(\"transform\", `translate(0,0)`)\r\n        .style(\"height\", 0)\r\n        .style(\"width\", 0)\r\n        .style(\"stroke\", \"none\")\r\n        .style(\"fill\", \"#ccc\")\r\n        .attr(\"x\", 0)\r\n        .attr(\"y\", 0)\r\n        .attr(\"opacity\", 0.05);\r\n\r\n      let $view = this;\r\n      d3.select(this.$refs.mapCanvasSelection)\r\n        .on(\"mousemove\", function() {\r\n          hoverbox.attr(\"visibility\", \"visible\");\r\n          [$view.hover.x, $view.hover.y] = d3.mouse(this);\r\n        })\r\n        .on(\"mouseout\", function() {\r\n          hoverbox.attr(\"visibility\", \"hidden\");\r\n        });\r\n    },\r\n    updateStations() {\r\n      let mapLayer = d3.select(this.$refs.mapSvg);\r\n      mapLayer\r\n        .append(\"g\")\r\n        .selectAll(\".station\")\r\n        .data(this.stations.features)\r\n        .enter()\r\n        .append(\"path\")\r\n        .attr(\"class\", \"station\")\r\n        .attr(\"d\", this.path)\r\n        .style(\"stroke\", \"none\")\r\n        .style(\"fill\", \"#ccc\")\r\n        .attr(\"opacity\", 0.05);\r\n    },\r\n    convertData() {\r\n      // convert coordinates\r\n      this.allIncidents.forEach(d => {\r\n        [d.x, d.y] = this.projection([d.long, d.lat]);\r\n      });\r\n    },\r\n    processAndFilterData() {\r\n      // filter data\r\n      let filtered = this.allIncidents.filter(d => {\r\n        return (\r\n          (d.mode_type == this.incidentType || this.incidentType == \"*\") &&\r\n          d.id < this.year * 100 + this.month\r\n        );\r\n      });\r\n      // transform data for heatmap input\r\n      this.heatmapData = filtered.map(d => [d.x, d.y, 1]);\r\n      // create a quadtree\r\n      this.quadtree = d3\r\n        .quadtree()\r\n        .x(d => d.x)\r\n        .y(d => d.y);\r\n      this.quadtree.addAll(filtered);\r\n      this.incidents = filtered;\r\n    },\r\n    updateHeatMap() {\r\n      this.$refs.mapvis.classList.remove(\"mapvis__visible\");\r\n      this.processAndFilterData();\r\n      let heat = simpleheat(this.$refs.mapCanvas);\r\n      heat.data(this.heatmapData);\r\n      heat.radius(1.5, 2);\r\n      heat.gradient({\r\n        1: d3.interpolateGreys(0.3),\r\n        0.5: d3.interpolateGreys(0.5),\r\n        0: d3.interpolateGreys(1)\r\n      });\r\n      heat.draw(0.05);\r\n      if (!this.$refs.mapvis.classList.contains(\"mapvis__visible\")) {\r\n        this.$refs.mapvis.classList.add(\"mapvis__visible\");\r\n      }\r\n    },\r\n\r\n    updateSelection({ selected, type }) {\r\n      this.selectedIncidents = selected.map(d => [d.x, d.y, 1]);\r\n      if (type == \"single\") {\r\n        this.updateSelectionSvg();\r\n        this.updateSelectionCanvas();\r\n      } else {\r\n        d3.select(this.$refs.mapSvgSelection)\r\n          .selectAll(\"*\")\r\n          .remove();\r\n        this.updateSelectionCanvas();\r\n      }\r\n    },\r\n    updateSelectionSvg() {\r\n      let svg = d3.select(this.$refs.mapSvgSelection);\r\n      svg.selectAll(\"*\").remove();\r\n      let circles = svg\r\n        .selectAll(\".selected--incident\")\r\n        .data(this.selectedIncidents)\r\n        .enter()\r\n        .append(\"circle\")\r\n        .attr(\"class\", \"selected--incident\")\r\n        .attr(\"cx\", d => d[0])\r\n        .attr(\"cy\", d => d[1])\r\n        .attr(\"r\", 4)\r\n        .attr(\"stroke\", \"#111\")\r\n        .attr(\"stroke-width\", \"1\")\r\n        .style(\"fill\", \"#288be4\")\r\n        .style(\"opacity\", 1);\r\n    },\r\n    updateSelectionCanvas() {\r\n      let heat = simpleheat(this.$refs.mapCanvasSelection);\r\n      heat.data(this.selectedIncidents);\r\n      heat.radius(3, 0);\r\n      heat.gradient({\r\n        1: d3.interpolateBlues(0.75),\r\n        0: d3.interpolateBlues(1)\r\n      });\r\n      heat.draw(0.05);\r\n    },\r\n    updateHoverSelection() {\r\n      let r = this.hover.r;\r\n      let [x0, y0] = [this.hover.x - r, this.hover.y - r];\r\n      let [x3, y3] = [this.hover.x, this.hover.y];\r\n      let points = [];\r\n      this.quadtree.visit((node, x1, y1, x2, y2) => {\r\n        if (!node.length) {\r\n          do {\r\n            var { x, y } = node.data;\r\n            let selected = x >= x0 && x < x3 && y >= y0 && y < y3;\r\n            if (selected) points.push(node.data);\r\n          } while ((node = node.next));\r\n        }\r\n        return x1 >= x3 || y1 >= y3 || x2 < x0 || y2 < y0;\r\n      });\r\n      this.$set(this, \"boxSelectedIncidents\", points);\r\n      this.numBoxSelectedIncidents = points && points.length;\r\n    },\r\n    moveHoverBox() {\r\n      let mapLayer = d3.select(this.$refs.mapSvg);\r\n      let { x, y, r } = this.hover;\r\n      let r2 = this.hover.r / 2;\r\n      mapLayer\r\n        .select(\".hoverbox\")\r\n        .attr(\"class\", \"hoverbox\")\r\n        .style(\r\n          \"transform\",\r\n          `translate(${this.hover.x - r}px,${this.hover.y - r}px)`\r\n        )\r\n        .style(\"height\", this.hover.r)\r\n        .style(\"width\", this.hover.r)\r\n        .style(\"stroke\", \"#fff\")\r\n        .style(\"storke-opacity\", 1)\r\n        .style(\"fill\", \"#288BE4\") //#ccc\r\n        .attr(\"opacity\", 0.5);\r\n    },\r\n    updateLegend() {}\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.mapvis {\r\n  &--container {\r\n    display: flex;\r\n    justify-content: space-around;\r\n    flex: 1;\r\n  }\r\n\r\n  display: inline-block;\r\n  position: relative;\r\n  opacity: 0;\r\n  transition: opacity 1s;\r\n\r\n  &__visible {\r\n    opacity: 1;\r\n  }\r\n\r\n  &--svg {\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: center;\r\n  }\r\n  &--canvas,\r\n  &--canvas__selection {\r\n    position: absolute;\r\n    left: 0;\r\n    z-index: 100;\r\n  }\r\n  &--canvas__selection {\r\n    z-index: 110;\r\n  }\r\n  &--canvas__selectionsvg {\r\n    z-index: 109;\r\n  }\r\n  &--title {\r\n    position: absolute;\r\n    left: 20px;\r\n    top: 40px;\r\n    z-index: 200;\r\n    font-weight: 100;\r\n  }\r\n}\r\n.sumvis {\r\n  &--container {\r\n    display: flex;\r\n    flex-direction: column;\r\n    flex: 1;\r\n  }\r\n  &--summary {\r\n    display: flex;\r\n    flex-direction: row;\r\n    padding-top: 50px;\r\n    margin-left: 30px;\r\n  }\r\n  &--description {\r\n    padding-top: 10px;\r\n    padding-left: 6px;\r\n    padding-right: 160px;\r\n    text-align: justify;\r\n    overflow: auto;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GeoHeatmap.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GeoHeatmap.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./GeoHeatmap.vue?vue&type=template&id=e15d8dee&scoped=true&\"\nimport script from \"./GeoHeatmap.vue?vue&type=script&lang=js&\"\nexport * from \"./GeoHeatmap.vue?vue&type=script&lang=js&\"\nimport style0 from \"./GeoHeatmap.vue?vue&type=style&index=0&id=e15d8dee&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e15d8dee\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\">\n    <header class=\"header\">\n      <h1 class=\"title\">\n        Boston Traffic Incidents\n        <span class=\"subtitle\">{{ yearsTitle }}</span>\n      </h1>\n      <nav class=\"header--navigation is-right\" v-if=\"isLoading != true\">\n        <b-field>\n          <b-radio-button\n            size=\"is-small\"\n            v-model=\"incidentType\"\n            native-value=\"*\"\n            title=\"Show all incident types\"\n          >\n            <span>All</span>\n          </b-radio-button>\n\n          <b-radio-button\n            size=\"is-small\"\n            v-model=\"incidentType\"\n            native-value=\"mv\"\n            title=\"Show incidents involving motor vehicles\"\n          >\n            <b-icon icon=\"car\" pack=\"mdi\" size=\"is-small\"></b-icon>\n            <span>Motor vehicle</span>\n          </b-radio-button>\n\n          <b-radio-button\n            size=\"is-small\"\n            v-model=\"incidentType\"\n            native-value=\"bike\"\n            title=\"Show incidents involving bikes\"\n          >\n            <b-icon icon=\"bike\" pack=\"mdi\" size=\"is-small\"></b-icon>\n            <span>Bike</span>\n          </b-radio-button>\n          <b-radio-button\n            size=\"is-small\"\n            v-model=\"incidentType\"\n            native-value=\"ped\"\n            title=\"Show incidents involving pedestrians\"\n          >\n            <b-icon icon=\"walk\" pack=\"mdi\" size=\"is-small\"></b-icon>\n            <span>Pedestrian</span>\n          </b-radio-button>\n        </b-field>\n      </nav>\n    </header>\n    <section class=\"vis\" v-show=\"isLoading != true\">\n      <geo-heatmap\n        :neighborhoods=\"neighborhoods\"\n        :stations=\"stations\"\n        :allIncidents=\"incidents\"\n        :allSummary=\"incidentsSummary\"\n        :year=\"year\"\n        :month=\"month\"\n        :incidentType=\"incidentType\"\n      ></geo-heatmap>\n    </section>\n    <div class=\"app--footer\">&copy; 2020 Ketul Mavani</div>\n  </div>\n</template>\n\n<script>\n// import HelloWorld from \"@/components/HelloWorld.vue\";\nimport axios from \"axios\";\nimport * as resources from \"@/data/resources\";\nimport GeoHeatmap from \"@/views/GeoHeatmap.vue\";\n// import { toggleSpinner } from \"@/utils\";\n\nexport default {\n  name: \"home\",\n  components: { GeoHeatmap },\n  data() {\n    return {\n      isLoading: true,\n\n      neighborhoods: undefined,\n      stations: undefined,\n      incidents: undefined,\n      incidentsSummary: {\n        yearly: undefined,\n        monthly: undefined,\n        hourly: undefined\n      },\n\n      incidentType: \"*\",\n\n      animate: false,\n      years: [],\n      year: 2015,\n      month: 1,\n\n      updateInterval: undefined\n    };\n  },\n  async beforeMount() {\n    let response;\n\n    response = await axios.get(resources.NEIGHBORHOODS);\n    this.neighborhoods = Object.freeze(response.data);\n    console.log(\"Retrieved Neighborhoods\");\n\n    response = await axios.get(resources.POLICE_STATIONS);\n    this.stations = Object.freeze(response.data);\n\n    response = await axios.get(resources.VISION_ZERO);\n    let years = new Set();\n    let summary = {};\n    response.data.data.forEach(d => {\n      years.add(d.year);\n      d.id = d.year * 100 + d.month;\n      d.lat = +d.lat;\n      d.long = +d.long;\n      summary[d.year] || (summary[d.year] = { year: d.year, total: 0 });\n      summary[d.year][d.mode_type] = (summary[d.year][d.mode_type] || 0) + 1;\n      summary[d.year][\"total\"] = (summary[d.year][\"total\"] || 0) + 1;\n    });\n    this.incidents = Object.freeze(response.data.data);\n    this.years.push(...years);\n    this.years.sort();\n    this.year = this.years[0];\n    this.incidentsSummary.yearly = Object.values(summary).map(s => ({\n      name: s.year,\n      ...s\n    }));\n    this.incidentsSummary.yearly.columns = [\"mv\", \"bike\", \"ped\"];\n    this.incidentsSummary.yearly.titles = {\n      mv: \"Motor Vehicle\",\n      bike: \"Bike\",\n      ped: \"Pedestrian\"\n    };\n    console.log(\"Retrieved Incidents Data\", summary);\n\n    if (this.animate) {\n      this.updateInterval = setInterval(() => {\n        this.updateMap();\n      }, 400);\n    } else {\n      this.year = this.years[this.years.length - 1];\n      this.month = 12;\n    }\n\n    this.isLoading = false;\n  },\n  watch: {},\n  computed: {\n    yearsTitle() {\n      if (this.years.length == 0) return \"\";\n      let first = this.years[0];\n      let last = this.years[this.years.length - 1];\n      return `${first} to ${last}`;\n    }\n  },\n  methods: {\n    updateMap() {\n      if (this.year == 2019 && this.month == 12) {\n        clearInterval(this.updateInterval);\n        this.updateInterval = undefined;\n        return;\n      }\n      if (this.month == 12) {\n        this.year = this.year + 1;\n        this.month = 1;\n      } else {\n        this.month++;\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\">\nhtml {\n  overflow-x: auto !important;\n  overflow-y: auto !important;\n}\nbody {\n  font-family: \"Montserrat\", \"Arial\", sans-serif;\n}\n#app {\n  font-family: \"Montserrat\", \"Arial\", sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  color: #aaa;\n  padding: 1rem;\n}\n.vis {\n  display: flex;\n  flex: 1;\n  font-weight: 100;\n  margin-top: 40px;\n}\n.header {\n  position: fixed;\n  left: 0;\n  top: 0;\n  height: 40px;\n  display: flex;\n  justify-content: space-between;\n  flex: 1;\n  padding: 1.5rem;\n  width: 100%;\n  &--navigation {\n    opacity: 0.75;\n  }\n}\n.app--footer {\n  position: fixed;\n  right: 0.75rem;\n  bottom: 0.5rem;\n  opacity: 0.4;\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=283c08bf&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","/* eslint-disable no-console */\n\nimport { register } from \"register-service-worker\";\n\nif (process.env.NODE_ENV === \"production\") {\n  register(`${process.env.BASE_URL}service-worker.js`, {\n    ready() {\n      console.log(\n        \"App is being served from cache by a service worker.\\n\" +\n          \"For more details, visit https://goo.gl/AFskqB\"\n      );\n    },\n    registered() {\n      console.log(\"Service worker has been registered.\");\n    },\n    cached() {\n      console.log(\"Content has been cached for offline use.\");\n    },\n    updatefound() {\n      console.log(\"New content is downloading.\");\n    },\n    updated() {\n      console.log(\"New content is available; please refresh.\");\n    },\n    offline() {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    },\n    error(error) {\n      console.error(\"Error during service worker registration:\", error);\n    }\n  });\n}\n","import Vue from \"vue\";\nimport VueRouter from \"vue-router\";\nimport GeoHeatmap from \"../views/GeoHeatmap.vue\";\n\nVue.use(VueRouter);\n\nconst routes = [\n  {\n    path: \"/\",\n    name: \"geo-heatmap\",\n    component: GeoHeatmap\n  }\n  // {\n  //   path: \"/about\",\n  //   name: \"about\",\n  //   // route level code-splitting\n  //   // this generates a separate chunk (about.[hash].js) for this route\n  //   // which is lazy-loaded when the route is visited.\n  //   component: () =>\n  //     import(/* webpackChunkName: \"about\" */ \"../views/About.vue\")\n  // }\n];\n\nconst router = new VueRouter({\n  routes\n});\n\nexport default router;\n","import Vue from \"vue\";\nimport Vuex from \"vuex\";\n\nVue.use(Vuex);\n\nexport default new Vuex.Store({\n  state: {\n    count: 0\n  },\n  mutations: {},\n  actions: {},\n  modules: {}\n});\n","import Vue from \"vue\";\nimport App from \"./App.vue\";\nimport \"./registerServiceWorker\";\nimport router from \"./router\";\nimport store from \"./store\";\nimport Buefy from \"buefy\";\nimport \"./assets/scss/app.scss\";\n\nVue.use(Buefy);\n\nVue.config.productionTip = false;\n\nnew Vue({\n  router,\n  store,\n  render: h => h(App)\n}).$mount(\"#app\");\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Heatmap.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Heatmap.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Barchart.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Barchart.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GeoHeatmap.vue?vue&type=style&index=0&id=e15d8dee&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GeoHeatmap.vue?vue&type=style&index=0&id=e15d8dee&lang=scss&scoped=true&\""],"sourceRoot":""}